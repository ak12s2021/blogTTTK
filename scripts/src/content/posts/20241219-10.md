---
title: "计算机网络ch3 运输层"
published: 2024-12-19
tags: []
category: "计算机网络笔记"
draft: false
---
<h1>ch3 运输层</h1>
<h2>服务</h2>
<p>　　为不同主机上的应用进程（应用层）之间提供逻<br />
辑通信<br />
 运输协议运行在端系统中（路由器不涉及）<br />
发送方：将应用报文划分为段，传向网络层<br />
接收方：将段重新装配为报文，传向应用层<br />
 应用可供使用的运输协议不止一个<br />
因特网：TCP和UDP</p>
<p>　　‍</p>
<p>　　依赖、强化网络层服务</p>
<p>　　‍</p>
<h2>3.2 多路复用与多路分解</h2>
<p>　　<em>家庭类比:<br />
12个孩子向12个孩子发信<br />
（Ann和Bill负责收发信件）<br />
◼ Bill从邮递员处收到一批信，通过查看收信人姓名将信<br />
件交付到其他人手中，他执行的就是一个多路分解操<br />
作。<br />
◼ Ann从其他人手中收集信件并交给邮递员时，她执行<br />
的就是一个多路复用操作。</em></p>
<p>​<img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/202412192129123.png" alt="image" />​</p>
<p>　　‍</p>
<p>　　主机接收IP数据报<br />
 每个数据报<strong>承载1个运输层段</strong><br />
 每个段具有源、目的端口号 （特定应用程序有周知端口号）<br />
 <strong>主机使用IP地址&端口号将段定向到适当的套接字</strong></p>
<p>　　‍</p>
<p>　　<strong>UDP套接字由二元组标识 :(目的地IP地址，目的地端口号)</strong></p>
<p>　　◼当主机接收UDP段时：<br />
◼ 在段中检查目的地端口号<br />
◼ 将UDP段定向到具有该端口号的套接字<br />
◼具有不同源IP地址和/或源端口号的IP数据报定向到相同的套接字</p>
<p>　　‍</p>
<p>　　‍</p>
<p>　　TCP套接字由四元组标识：<br />
<strong>源IP地址-源端口号-目的IP地址-目的端口号</strong></p>
<p>　　<strong>Web服务器对每个连接的客户机具有不同的套接字</strong></p>
<p>　　‍</p>
<h2>Web服务器对每个连接的客户机具有不同的套接字</h2>
<p>　　‍</p>
<h2>3.4可靠数据传输</h2>
<h3>1. 数据包和序列号</h3>
<ul>
<li><strong>数据包</strong>：数据在网络中被分割成小块，称为数据包。</li>
<li><strong>序列号</strong>：每个数据包都有一个唯一的序列号，用于标识数据的顺序。这有助于接收方按正确的顺序重组数据。</li>
</ul>
<h3>2. 确认（ACK）</h3>
<ul>
<li><strong>确认机制</strong>：接收方在成功接收到数据包后，会发送一个确认消息（ACK）回发送方，表示该数据包已成功接收。</li>
<li><strong>超时重传</strong>：如果发送方在一定时间内未收到ACK，它会重传该数据包。</li>
</ul>
<h3>3. 数据完整性检查</h3>
<ul>
<li><strong>校验和</strong>：在发送数据包时，发送方计算数据的校验和，并将其附加到数据包中。接收方在接收到数据包后，重新计算校验和并与附加的校验和进行比较，检查数据是否完整且未被篡改。</li>
</ul>
<h3>4. 流量控制</h3>
<ul>
<li><strong>流量控制</strong>：为了防止接收方处理不过来，发送方会根据接收方的处理能力调整发送速率。这可以通过滑动窗口协议等方法实现。</li>
</ul>
<h3>5. 拥塞控制</h3>
<ul>
<li><strong>拥塞控制</strong>：在网络拥堵时，发送方会减少数据发送速率，以避免进一步加剧拥塞。这通常通过监测网络的延迟和数据包丢失情况来实现。</li>
</ul>
<p>​<img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/202412192129411.png" alt="image" />​</p>
<p>　　‍</p>
<p>　　‍</p>
<h2><code>3.6 拥塞控制原理</code>​</h2>
<p>　　表现：<br />
◼ 丢包 (路由器缓存区溢出)<br />
◼ 长时延 (路由器缓存区中排队)</p>
<h1>拥塞控制的两种方法详解</h1>
<h2>端到端的拥塞控制</h2>
<h3>基本特征</h3>
<ol>
<li>
<p><strong>信息获取方式</strong></p>
<ul>
<li>没有从网络获得明确的拥塞反馈</li>
<li>完全依赖端系统（发送方和接收方）自身的观察和推断</li>
</ul>
</li>
<li>
<p><strong>拥塞检测机制</strong></p>
<ul>
<li>
<p>通过观察网络中的关键指标来推断拥塞状况</p>
</li>
<li>
<p>主要观测指标：</p>
<ul>
<li>数据包传输延迟</li>
<li>数据包丢失情况</li>
<li>网络吞吐量变化</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>典型实现</strong></p>
<ul>
<li>
<p>TCP协议广泛采用这种方法</p>
</li>
<li>
<p>主要通过以下机制实现：</p>
<ul>
<li>慢启动</li>
<li>拥塞避免</li>
<li>快重传</li>
<li>快恢复</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3>工作原理</h3>
<ul>
<li>发送方通过观察ACK返回情况</li>
<li>分析往返时间（RTT）</li>
<li>监控数据包丢失率</li>
<li>动态调整发送窗口大小</li>
</ul>
<h2>网络辅助的拥塞控制</h2>
<h3>基本特征</h3>
<ol>
<li>
<p><strong>信息获取方式</strong></p>
<ul>
<li>路由器主动为端系统提供拥塞反馈</li>
<li>直接的网络层拥塞信号</li>
</ul>
</li>
<li>
<p><strong>拥塞信号机制</strong></p>
<ul>
<li>
<p>使用最简单的方式：单个比特指示链路拥塞状态</p>
</li>
<li>
<p>常见于不同网络协议：</p>
<ul>
<li>SNA（系统网络架构）</li>
<li>DECnet</li>
<li>TCP/IP ECN（显式拥塞通知）</li>
<li>ATM（异步传输模式）</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>控制方法</strong></p>
<ul>
<li>路由器直接告知发送方降低发送速率</li>
<li>提供精确的网络拥塞状态信息</li>
</ul>
</li>
</ol>
<h3>工作原理</h3>
<ul>
<li>网络设备（路由器）实时监控链路负载</li>
<li>当链路接近饱和时，设置拥塞标志</li>
<li>通过特定信号通知发送方调整发送速率</li>
</ul>
<h2>两种方法的对比</h2>
<div>
<pre class="font-styrene border-border-100/50 overflow-x-scroll whitespace-nowrap rounded border-[0.5px] shadow-[0_2px_12px_rgba(0,0,0,0.05)]"><table class="bg-bg-100 min-w-full border-separate border-spacing-0 text-sm leading-[1.88888]"><thead class="border-b-border-100/50 border-b-[0.5px] text-left"><tr class="[tbody>&]:odd:bg-bg-500/10"><th class="text-text-000 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] font-400 px-2 [&:not(:first-child)]:border-l-[0.5px]">特征</th><th class="text-text-000 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] font-400 px-2 [&:not(:first-child)]:border-l-[0.5px]">端到端拥塞控制</th><th class="text-text-000 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] font-400 px-2 [&:not(:first-child)]:border-l-[0.5px]">网络辅助拥塞控制</th></tr></thead><tbody><tr class="[tbody>&]:odd:bg-bg-500/10"><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">信息来源</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">端系统自身观察</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">网络设备直接提供</td></tr><tr class="[tbody>&]:odd:bg-bg-500/10"><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">实现复杂度</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">相对复杂</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">相对简单</td></tr><tr class="[tbody>&]:odd:bg-bg-500/10"><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">适用协议</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">TCP</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">SNA, DECnet, ECN</td></tr><tr class="[tbody>&]:odd:bg-bg-500/10"><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">反馈精确度</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">间接推断</td><td class="border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]">直接指示</td></tr></tbody></table></pre>
</div>
<h2>两种方法的对比</h2>
<p>　　‍</p>
<h2>优缺点分析</h2>
<h3>端到端拥塞控制</h3>
<p>　　<strong>优点</strong>：</p>
<ul>
<li>不需要网络设备额外支持</li>
<li>适应性强</li>
<li>可以应用于各种网络环境</li>
</ul>
<p>　　<strong>缺点</strong>：</p>
<ul>
<li>反应可能较慢</li>
<li>依赖间接推断</li>
<li>可能出现滞后</li>
</ul>
<h3>网络辅助拥塞控制</h3>
<p>　　<strong>优点</strong>：</p>
<ul>
<li>反馈精确直接</li>
<li>网络设备可以实时告知拥塞情况</li>
<li>控制更加精准</li>
</ul>
<p>　　<strong>缺点</strong>：</p>
<ul>
<li>需要网络设备支持</li>
<li>实现成本较高</li>
<li>可能增加网络复杂度</li>
</ul>
<h2>实际应用思考</h2>
<p>　　在实际网络中，这两种方法often是互补的。现代网络协议倾向于结合两种方法的优点，以获得更好的拥塞控制效果。</p>
<h2>结语</h2>
<p>　　理解拥塞控制不仅仅是技术细节，更是网络资源合理利用的艺术。通过巧妙的机制，我们可以让数据在网络中高效、公平地传输。</p>
<p>　　希望这个详细的解释能帮助你深入理解拥塞控制的两类方法。如果你有任何疑问，随时可以问我！</p>
