---
title: "使用ppt自带vba批量生成pdf"
published: 2024-09-26
tags: []
category: "实用工具"
draft: false
---
<!-- wp:paragraph -->
<p>上课老师发的ppt打开太慢，而且文字经常出现乱码，遂想批量转换为pdf</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926193215-m4k4m3f">PPT批量转换pdf</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926193336-hxyrh86">（用的VBA）</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926193342-zqzo5nx">使用方法：</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926193411-7vphyll">1.打开ppt页面</p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>​</code></pre>
<!-- /wp:code -->

<!-- wp:image {"id":330,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20193421.png" alt="" class="wp-image-330"/></figure>
<!-- /wp:image -->

<!-- wp:list {"ordered":true,"start":2} -->
<ol start="2" id="20240926193424-p9622w6" class="wp-block-list"><!-- wp:list-item -->
<li>按Alt+F11进入VBA宏编辑</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>点击插入模块 </li>
<!-- /wp:list-item --></ol>
<!-- /wp:list -->

<!-- wp:image {"id":327,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20193516.png" alt="" class="wp-image-327"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true,"start":2} -->
<ol start="2" id="20240926193424-p9622w6" class="wp-block-list"><!-- wp:list-item -->
<li>把下面的代码复制进去</li>
<!-- /wp:list-item --></ol>
<!-- /wp:list -->

<!-- wp:code -->
<pre class="wp-block-code"><code>Sub ConvertPPTsToPDFs()
    Dim xFolder As String
    Dim xFileName As String
    Dim pptApp As Object
    Dim pptPresentation As Object
    Dim xNewName As String
    Dim xIndex As Integer

    ' 直接指定文件夹路径
    xFolder = "D:\库\singal and system\ppt\"
    
    ' 创建PowerPoint应用程序对象
    Set pptApp = CreateObject("PowerPoint.Application")
    pptApp.Visible = True

    ' 获取文件夹中的第一个文件
    xFileName = Dir(xFolder & "*.*", vbNormal)
    While xFileName <> ""
        ' 检查文件是否为PowerPoint文件
        If (Right(xFileName, 4) = ".ppt" Or Right(xFileName, 5) = ".pptx") Then
            ' 打开PowerPoint文件
            Set pptPresentation = pptApp.Presentations.Open(xFolder & xFileName)
            
            ' 获取文件扩展名的位置
            xIndex = InStrRev(xFileName, ".")
            ' 创建新的文件名
            xNewName = Left(xFileName, xIndex - 1) & ".pdf"
            
            ' 导出为PDF
            pptPresentation.SaveAs xFolder & xNewName, 32 ' 32表示PDF格式
            
            ' 关闭演示文稿
            pptPresentation.Close
        End If
        ' 获取下一个文件
        xFileName = Dir()
    Wend
    
    ' 关闭PowerPoint应用程序
    pptApp.Quit
    Set pptApp = Nothing

    MsgBox "所有PowerPoint文件已转换为PDF格式。"
End Sub</code></pre>
<!-- /wp:code -->

<!-- wp:code -->
<pre class="wp-block-code"><code>
​</code></pre>
<!-- /wp:code -->

<!-- wp:image {"id":326,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20195054.png" alt="" class="wp-image-326"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="20240926195104-0xzm4xc">6.然后把文件目录，也就是最上面这一行“D:\库\数字信号处理”替换掉</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>换成自己存放ppt的文件夹的地址</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>例如：C:\Users\ak12s\Pictures\Screenshots</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>注意不要把引号删掉哦(⊙o⊙)？</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926194243-1epw5uw">​</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":324,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20195712.png" alt="" class="wp-image-324"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="20240926195715-fu4flul">​</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926195717-enk21ta">替换后</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926195735-piis7w0">7.点击运行：</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p id="20240926195735-piis7w0">​</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":328,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://cbt567.oss-rg-china-mainland.aliyuncs.com/img/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-26%20195730.png" alt="" class="wp-image-328"/></figure>
<!-- /wp:image -->
